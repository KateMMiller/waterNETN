---
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width = 10)
```

```{css echo = FALSE}
.indent {
margin-left: 25px;
font-size: 14px;
}

.indent2 {
margin-left: 50px;
font-size: 12px;
}
```

## Using the waterNETN R package {.tabset .tabset-pills}

### Getting started

<h4><b>Step 1.</b> Install R, RStudio, and RTools in Software Center</h4>
<h4><b>Step 2.</b> Install devtools package in R:</h4>
```{r, eval = F, class.source = "indent"}
install.packages('devtools')
```
<h4><b>Step 3.</b> Install waterNETN from github</h4>
```{r, eval = F, class.source = "indent"}
library(devtools)
install_github("KateMMiller/waterNETN")
```
<h4><b>Step 4.</b> Load waterNETN R package</h4>
```{r, class.source = "indent"}
library(waterNETN)
```
<h4><b>Step 5.</b> Import data</h4>
Note that R is not able to connect to files on Sharepoint or MS Teams (b/c Teams also stores all files on Sharepoint). That means you need to store data package files on your local machine or on a server (e.g. NETN Z drive).
```{r echo = F, results = 'hide', include = F}
importData()
```
<p class = 'indent'>
<b>Option 1.</b> Import data via .csv files. The file path should be where csvs are on your machine or server.</p>
```{r, eval = F, class.source = "indent"}
importData(type = 'csv',
           filepath = "C:/NETN/R_Dev/Water/data") # update filepath to your computer
```
<p class = 'indent'>
<b>Option 2.</b> Import data via zip file of csvs. The filepath should be the location and name of the zip file.</p>
```{r eval = F, class.source = "indent"}
importData(type = 'zip',
           filepath = "C:/NETN/R_Dev/Water/data/NETN_Water_Data_Package_20240423.zip")
```
<p class = 'indent'>
<b>Option 3.</b> Import data via data package database file on your computer</p>
```{r eval = F, class.source = "indent"}
importData(type = 'dbfile',
           filepath = "C:/NETN/R_Dev/Water/data/NETN_h3Ov4_DataPackage_202331115.accdb")
```
<p class = 'indent'>
<b>Option 4.</b> Import data via data package database DSN (Data Source Name) on your computer. Note that this is the default setting. As long as you have a named DSN called "NETNWQ_DP" that links to the data package database, and that database links to the latest NETN WQ backend database, the code below will run. See <i>Setting up DSN</i> tab for how to set up DSN.</p>
```{r eval = F, class.source = "indent"}
importData() # easiest
importData(type = 'DSN', odbc = "NETNWQ_DP") # equivalent to line above
```

### Setting up DSN
<h4><b>Setting up a DSN</b></h4>
<ol>
<li>Go to Windows Start Menu and search ODBC. Click on ODBC Data Sources (64-bit) </li>

```{r echo = F, out.height = 350, fig.align = 'center'}
knitr::include_graphics("C:/NETN/R_Dev/Water/waterNETN/testing_scripts/ODBC_step_1.jpg")
```
<li>Click on <i>Add</i>, then select <i>Microsoft Access Driver (\*.mdb, \*.accdb)</i> then click <i>Finish</i> in next menu.</li>

```{r echo = F, out.height = 400, fig.align = 'center'}
knitr::include_graphics("C:/NETN/R_Dev/Water/waterNETN/testing_scripts/ODBC_step_2.jpg")
```

<li>Enter <b>NETNWQ_DP</b> into the Data Source Name (red arrow), click on Select (red circle). In new window, click on C:/ (orange arrow) and find the path to your database. If it's on the Z drive, then click on the Drives window and select correct Drive. Click on the data package database (yellow arrow). When complete, click OK. Finally, add the name of the database file to the Description (blue arrow), so it's easier to check whether you're using the latest version.  </li>
```{r echo = F, out.height = 400, fig.align = 'center'}
knitr::include_graphics("C:/NETN/R_Dev/Water/waterNETN/testing_scripts/ODBC_step_3.jpg")
```

<li>If updating an existing DSN, follow similar process, except click on the DSN in the first window and select <i>Configure</i> instead of Add.</li>
</ol>

